<!DOCTYPE html>
<html lang="en" ng-app='myApp'>
<head>
	<meta charset="UTF-8">
	<title>use angular</title>
	<style>
		.outDiv {
			width: 800px;height: 130px;background-color: red;
		}
		.innerDiv {
			background-color: blue;width: 100px;height: 100px;float: left;line-height: 30px;text-align: center;
		}
		.innerDiv .tt {
			color: white;font-size: 20px;margin-left: 5px;
		}
		.outDiv a {
			line-height: 40px;margin-left: 300px;
		}
		li {
			background-color: #999;width: 400px;line-height: 24px;color: green;
		}
		li a {
			float: right;
		}
		li span{
			color: black;
		}
	</style>
</head>
<body>



	<div ng-controller="main">
		<yq-showList ng-show="listFlag"></yq-showList>
		<yq-getpage   ng-show="!listFlag"></yq-getpage>
		<button ng-click="change()">change</button>
		<yq-addpage></yq-addpage>
	</div>
	<div ng-controller="useSub">
		<button ng-click="getUserList()">sub</button>
	</div>
</body>
<script type="text/javascript" src="/bower_components/angular/angular.js"></script>
<script type="text/javascript" src="/bower_components/angular/angular-route.min.js"></script>
<script type="text/javascript" src="/bower_components/angular/angular-resource.js"></script>
<script type="text/ng-template" id="addTemp">
	<div>
		<ul ng-repeat="add in adds">
			<li><span>name:</span> {{ add.name }}&nbsp;&nbsp;&nbsp;
			<span>sex:</span> {{ add.sex }} &nbsp;&nbsp;&nbsp;
			<span>socre:</span>{{ add.score }}
			<a href="#" ng-click="delete(add)" >delete</a>
			</li>
		</ul>			
	</div>
</script>
<script type="text/ng-template" id="listTemp">
	<div class="outDiv">
		<div ng-repeat="stu in stus">
			<div class="innerDiv">
				name:<span class="tt">{{ stu.name }}</span><br>
				sex:<span class="tt">{{ stu.sex }}</span> <br>
				score:<span class="tt">{{ stu.score }}</span> <br>
				<button ng-click="addStu(stu);">ADD</button>
			</div>
		</div>
	</div>
</script>
<script type="text/ng-template" id="getTemp">
	<div class="outDiv">
		<p><a href="#" ng-click="getUsers()">getUser</a></p>
	</div>
</script>
<script type="text/javascript">
	Array.prototype.remove = function(obj){
		var flag = false;
		for(var i=0;i<this.length;i++){
			if(this[i] == obj){
				flag = !flag;
				break;
			}
		}
		if(flag)this.splice(i,1);
	}

	var app = angular.module('myApp',[]);
	app.factory('$_getUser',[
		function(){
			return {
				get:function(){
					return [
						{_id:1,name:'lala1',sex:'man1',score:'801'},
						{_id:2,name:'lala2',sex:'man2',score:'802'},
						{_id:3,name:'lala3',sex:'man3',score:'803'},
						{_id:4,name:'lala4',sex:'man4',score:'804'},
					]
				}
			}
		}
	]);

	app.service('$_saveAdd',[function(){
		var load = [];
		return {
			set:function(array){
				load = array;
			},
			get:function(){
				return load;
			}
		}
	}])

	app.directive('yqShowlist',function(){
		return {
			restrict:'EAC',
			templateUrl:'listTemp'
		}
	})

	app.directive('yqGetpage',function(){
		return {
			restrict:'EAC',
			templateUrl:'getTemp'
		}
	})

	app.directive('yqAddpage',function(){
		return {
			restrict:'EAC',
			templateUrl:'addTemp'
		}
	})

	app.controller('main',['$scope','$_getUser','$_saveAdd',
		function($scope,$_getUser,$_saveAdd){
			$scope.adds = [];
			$scope.change = function(){
				$scope.stus = $_getUser.get();
				$scope.listFlag = !$scope.listFlag;
			}
			$scope.addStu = function(stu){
				$scope.adds.push(stu);
				$_saveAdd.set($scope.adds);
			}
			$scope.delete = function(stu){
				$scope.adds.remove(stu);
			};
			$scope.getUsers = function(){
				console.log($_saveAdd.get());
			}
		}
	]);

	app.controller('useSub',['$scope','$_saveAdd',
		function($scope,$_saveAdd){
			$scope.getUserList = function(){
				console.log($_saveAdd.get());
			}
		}
	])
</script>
</html>